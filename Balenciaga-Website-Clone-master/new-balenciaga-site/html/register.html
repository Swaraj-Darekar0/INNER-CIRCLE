<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register | Balenciaga</title>

    <link rel="shortcut icon" href="../images/logos/favicon-48x48.png">

    <meta property="og:images" content="../images/more/ogimage.png">

    <!--css-->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/sample.css">

    <!--js-->
    <script src="../js/main.js"></script>

    <!--Ion-icons-->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <!--Google-icons-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!--SMTP-->
    <script src="https://smtpjs.com/v3/smtp.js"></script>
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
</head>



<body>
    <header>
        <div class="header flex w-full px-20 py-10 border-b" id="header">
            <div class="menu-icon hidden col-5">
                <div class="w-fit">
                    <span id="open-icon" class="material-symbols-outlined">menu</span>
                    <span id="close-icon" class="material-symbols-outlined">close</span>
                </div>
            </div>

            <div class="menu col-5">
                <ul class="flex justify-start space-x-20">
                    <li class="slideToggle"><a>Shop</a>
                        <div class="subnav flex slideToggleContent">
                            <ul class="col-2 space-y-10">
                                <li>Ready to wear</li>
                                <li><a href="./products.html?category=jackets">Jackets</a></li>
                                <li><a href="./products.html?category=tshirts">T-shirts</a></li>
                                <li><a href="./products.html?category=pants">Pants</a></li>
                                <li><a href="./products.html?category=activewear">Activewear</a></li>
                            </ul>
                            <!-- <ul class="col-2 space-y-10">
                                <li>Shoes</li>
                                <li></li>
                                <li><a href="#">Sneakers</a></li>
                                <li><a href="#">Boots & Derbies</a></li>
                            </ul> -->
                            <ul class="col-2 space-y-10">
                                <li>Bags</li>
                                <!-- <li><a href="#">Bags & totes</a></li> -->
                                <li><a href="./products.html?category=backpacks">Backpacks</a></li>
                            </ul>
                            <!-- <ul class="col-2 space-y-10">
                                <li>Accessories</li>
                                <li></li>
                                <li><a href="#">Sunglasses</a></li>
                                <li><a href="#">Shocks</a></li>
                            </ul> -->
                            <ul class="col-2 space-y-10">
                                <li><a href="./products.html">VIEW ALL</a></li>
                            </ul>
                        </div>
                    </li>

                    <li><a href="./campaign.html">Campaign</a></li>

                    <li class="slideToggle"><a>Explore</a>
                        <div class="subnav flex slideToggleContent">
                            <ul class="col-2 space-y-10">
                                <li>Collections</li>
                                <li><a href="./summer23.html">Summer 23</a></li>
                                <li><a href="./spring23.html">Spring 23</a></li>
                            </ul>
                            <ul class="col-2 space-y-10">
                                <li>History</li>
                                <li><a href="./ristobalbalenciaga.html">Ristóbal Balenciaga</a></li>
                                <li><a href="./demnagvasalia.html">Demna Gvasalia</a></li>
                            </ul>
                        </div>
                    </li>
                    <li><a href="./contactus.html">Contact us</a></li>
                    <li class="hidden"><a href="./login.html">Log in</a></li>
                </ul>
            </div><!--menu-->

            <div class="logo col-2 text-center">
                <a href="../index.html" class="text-15">
                    <span class="font-bold">BALENCIAGA</span>
                </a>
            </div><!--logo-->

            <div class="setting col-5">
                <ul class="flex justify-end space-x-20">
                    <li class="flex dark-light-icon">
                        <span id="light-icon" class="material-symbols-outlined">light_mode</span>
                        <span id="dark-icon" class="material-symbols-outlined">dark_mode</span>
                    </li>
                    <li class="cart slideToggle">
                        <a class="cart-icon flex"><span class="material-symbols-outlined">work</span><span id="countInCart" class="flex">0</span></a>
                        <div class="subnav slideToggleContent">
                            <div class="cart-item-list">
                            </div><!--cart-item-list-->
                            <div class="cart-item flex cart-subtotal">
                                <h6>Subtotal </h6>
                                <h6>$ <span id="cartSubtotal">0</span></h6>
                            </div>
                            <div class="cart-viewdetail">
                                <a href="./cart.html">View details</a>
                            </div>
                        </div>
                    </li>
                    <li class="setting-login"><a href="./login.html">Log in</a></li>
                </ul>
            </div><!--setting-->
        </div>
    </header>



    <div class="container">

        <div class="login-content1 flex min-h-screen p-20">

            <form class="col-6 m-auto" autocomplete="off">
                <div class="py-20 text-center">
                    <h5 class="text-center uppercase">CREATE AN PROFILE</h5>
                    <p>Create a profile and benefit from order delivery updates and return management as well as personalized recommendations</p>
                </div>

                <div class="form-row">
                    <label for="">Civility *</label>
                    <select name="civility" id="civility" data-error-missing='*Please select your civility, example "Mr" or "Mrs".' required>
                        <option value="" hidden></option>
                        <option value="Mr.">Mr.</option>
                        <option value="Miss, Mrs, Ms">Miss, Mrs, Ms</option>
                        <option value="I'd rather not to say">I'd rather not to say</option>
                    </select>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">First Name *</label>
                    <input type="text" name="firstName" id="firstName" pattern="^[a-zA-ZÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ\s]{1,50}$" maxlength="50" data-error-missing='*Please fill out your first name in this field, example "John".' data-error-length='1, 50' data-error-parse='*Invalid format. Special characters not allowed for your first name' placeholder="" required>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Last Name *</label>
                    <input type="text" name="lastName" id="lastName" pattern="^[a-zA-ZÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ\s]{1,50}$" maxlength="50" data-error-missing='*Please fill out your last name in this field, example "Smith".' data-error-length='1, 50' data-error-parse='*Invalid format. Special characters not allowed for your last name' placeholder="" required>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Date of birth (MM/DD/YYYY) *</label>
                    <input type="date" name="birthdate" id="birthdate" pattern="" maxlength="10" data-error-missing='*Please insert your birthdate.' data-error-length='8 12' data-error-parse='*Please insert a valid birthdate.' placeholder="" required>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Email *</label>
                    <input type="email" name="email" id="email" pattern="^([a-zA-Z0-9_\.\-\+]+)@([\da-zA-Z\.\-]+)\.([a-zA-Z\.]{2,12})$" maxlength="50" data-error-missing='*Please add your e-mail address, example: "john.smith@email.com"' data-error-length='3 50' data-error-parse='*Invalid email format. Please try again, example "john.smith@email.com".' placeholder="" required>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Password *</label>
                    <input type="password" name="password" id="password"  maxlength="30" data-error-missing='*Please fill out a password in this field according to the security rules.' data-error-length='6 30' data-error-parse='*Incorrect password. Only letters and numbers are allow in this filed.' placeholder="" required>
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Phone Number</label>
                    <input type="tel" name="phoneNumber" id="phoneNumber" pattern="^\+?[0-9]{7,15}$" maxlength="15" data-error-parse='*Invalid phone number format.' placeholder="">
                    <div class="form-row-error"></div>
                </div>

                <div class="form-row">
                    <label for="">Region / Country *</label>
                    <select name="country" id="country" data-error-missing='Select your country/region' required>
                        <option value="" hidden></option>
                        <option value="Viet Nam">Viet Nam</option>
                        <option value="United States">United States</option>
                    </select>
                    <div class="form-row-error"></div>
                </div>

                <div class="hide-text form-row mt-40">
                    <b>You are invited to read our privacy policy in full.</b> In any event, here are some key points we would like to share with you:
                    <br> <br>
                    <b>You are about to create your Balenciaga and Kering profile.</b> This will allow Balenciaga and Kering to  offer you a personalized and tailored experience, provide you with products, services and information you request from Balenciaga and Kering and communicate with you. All your personal information will be kept, used and linked to your Balenciaga and Kering profile. Your profile could include information we obtained directly from you as well as from our retailers and other commercial partners. As we operate globally, <b>we may securely share your personal information with companies of our group and our approved partners located around the world. We will implement safeguards to protect your personal information.</b> We may use any contact information you share with us to contact you.
                    <br> <br>
                    Privacy laws may grant you certain rights such as the right to access, delete, modify and rectify your data, or to restrict or object to processing, as well as the right to data portability. You can also lodge a complaint with your competent regulator. You can withdraw your consent or delete your profile at any time. For further information regarding our privacy practices and your rights, please contact us at privacy@balenciaga.com.
                    <br> <br>
                </div>

                <div class="form-row">
                    <div class="custom-checkbox">
                        <label>I acknowledge the terms of the privacy policy.                
                            <input type="checkbox" name="agree" id="agree" value="agree" data-error-missing='*Please agree to the Kering Service and Legal Privacy Policy to create an account.' required>
                            <span class="checkmark"></span>
                        </label>
                    </div>
                    <div class="form-row-error"></div>
                </div>
                
                <div class="form-row mt-40">
                    <input type="submit" name="submit" class="black-button w-full" value="Create my profile">
                </div>

                <div class="form-row text-center mt-40 mb-20">
                    <a href="./login.html" class="col-12 underline">Already have a profile? Log in</a>
                </div>
            </form>
        </div><!--login-content1-->

    </div><!--container-->



    <footer class="border-t">
        <div class="footer grid grid-cols-5 gap-20px px-20 py-40">
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Newsletter</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Subscribe to our newsletter</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Client services</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Track order</a></li>
                    <li><a href="#">Returns</a></li>
                    <li><a href="#">Delivery</a></li>
                    <li><a href="#">Payment</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">The company</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Careers - Design</a></li>
                    <li><a href="#">Legal</a></li>
                    <li><a href="#">Privacy policy and cookies</a></li>
                    <li><a href="#">World food programme</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Connect</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">Youtube</a></li>
                </ul>
            </div>
            <div class="slideToggle">
                <h6 class="uppercase mb-10">Boutiques</h6>
                <ul class="slideToggleContent space-y-5">
                    <li><a href="#">Find a store nearby</a></li>
                    <li><a href="#">Language: English</a></li>
                </ul>
            </div>
        </div><!--footer-->

        <div class="w-full border-t text-center p-10">
            <p>© Balenciaga</p>
        </div>
    </footer>





    <script>
        // Initialize Supabase client
        const SUPABASE_URL = 'https://xlhchehzuivgqulmbagp.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsaGNoZWh6dWl2Z3F1bG1iYWdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5OTEwMDYsImV4cCI6MjA2NzU2NzAwNn0.30mPdBWCkts7gW_EQ93Ilpa_qKvylrp5y6x1sZUUyAs';
        const supabase = Supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        document.getElementsByTagName("form")[0].addEventListener("submit", async function(e) {
            e.preventDefault();

            const civility = document.getElementById('civility').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const birthdate = document.getElementById('birthdate').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const country = document.getElementById('country').value;

            // 1. Sign up user with Supabase Auth
            const { data: authData, error: authError } = await supabase.auth.signUp({
                email: email,
                password: password,
            });

            if (authError) {
                alert('Registration failed: ' + authError.message);
                return;
            }

            if (authData.user) {
                // 2. Insert additional profile data into public.profiles table
                const { error: profileError } = await supabase
                    .from('profiles')
                    .insert({
                        id: authData.user.id,
                        civility: civility,
                        first_name: firstName,
                        last_name: lastName,
                        date_of_birth: birthdate,
                        phone_number: phoneNumber,
                        country: country,
                        email: email // Store email here for easy lookup, though auth.users also has it
                    });

                if (profileError) {
                    alert('Error saving profile details: ' + profileError.message);
                    // Optionally, you might want to delete the user from auth.users if profile creation fails
                    // await supabase.auth.admin.deleteUser(authData.user.id);
                    return;
                }

                alert('Registration successful! Please check your email to verify your account.');
                window.location.href = './login.html'; // Redirect to login page
            } else {
                // This case handles when user is not immediately available (e.g., email confirmation needed)
                alert('Please check your email to verify your account to complete registration.');
                window.location.href = './login.html';
            }
        });

        //live validation and on submit
        //[array element, type, event]
        let arrOnEvent = [
            [document.querySelectorAll("input:not(input[type=checkbox], input[type=submit])"), "input", "keyup blur"]
        ];

        // Remove the call to onEvent to prevent conflicts
        // onEvent(arrOnEvent);
    </script>
</body>
</html>